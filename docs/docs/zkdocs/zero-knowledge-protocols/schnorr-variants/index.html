<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Common variants of Schnorr&rsquo;s protocol.">
<meta name="theme-color" content="#FFFFFF">
<meta name="color-scheme" content="light dark"><meta property="og:title" content="Variants of Schnorr&#39;s identification protocol" />
<meta property="og:description" content="Common variants of Schnorr&rsquo;s protocol." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://expert-potato-772c18b7.pages.github.io/docs/zkdocs/zero-knowledge-protocols/schnorr-variants/" /><meta property="article:section" content="docs" />



<title>Variants of Schnorr&#39;s identification protocol | ZKDocs</title>
<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/book.min.cb29ef23964b7447b575f956b7722c60d044bd85de64b492255d7a53f41f3bcc.css" integrity="sha256-yynvI5ZLdEe1dflWt3IsYNBEvYXeZLSSJV16U/QfO8w=" crossorigin="anonymous">
  <script defer src="/flexsearch.min.js"></script>
  <script defer src="/en.search.min.a2da3ff1f1cdfb439cb717a2ab25cd83985879ac0fce7f3681ed5652deaecbab.js" integrity="sha256-oto/8fHN&#43;0OctxeiqyXNg5hYeawPzn82ge1WUt6uy6s=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><span>ZKDocs</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>












  



  
  <ul>
    
      
        <li class="book-section-flat" >
          
  
  

  
    <a href="https://expert-potato-772c18b7.pages.github.io/docs/zkdocs/" class="">Introduction</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://expert-potato-772c18b7.pages.github.io/docs/zkdocs/notation/" class="">Notation &amp; Definitions</a>
  

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <a href="https://expert-potato-772c18b7.pages.github.io/docs/zkdocs/zero-knowledge-protocols/" class="">Zero-knowledge protocols</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://expert-potato-772c18b7.pages.github.io/docs/zkdocs/zero-knowledge-protocols/schnorr/" class="">Schnorr&#39;s identification protocol</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://expert-potato-772c18b7.pages.github.io/docs/zkdocs/zero-knowledge-protocols/schnorr-variants/" class=" active">Variants of Schnorr&#39;s identification protocol</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://expert-potato-772c18b7.pages.github.io/docs/zkdocs/zero-knowledge-protocols/product-primes/" class="">Number is product of two primes</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://expert-potato-772c18b7.pages.github.io/docs/zkdocs/zero-knowledge-protocols/product-primes/square-freeness/" class="">Number is square-free</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://expert-potato-772c18b7.pages.github.io/docs/zkdocs/zero-knowledge-protocols/product-primes/two-prime-divisors/" class="">Two prime divisors</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://expert-potato-772c18b7.pages.github.io/docs/zkdocs/zero-knowledge-protocols/product-primes/product-of-two-primes/" class="">Product of two primes</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://expert-potato-772c18b7.pages.github.io/docs/zkdocs/zero-knowledge-protocols/product-primes/paillier_blum_modulus/" class="">Paillier-Blum Modulus</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://expert-potato-772c18b7.pages.github.io/docs/zkdocs/zero-knowledge-protocols/girault-identification/" class="">Girault&#39;s identification protocol</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://expert-potato-772c18b7.pages.github.io/docs/zkdocs/zero-knowledge-protocols/short-factoring-proofs/" class="">Short factoring proofs</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <a href="https://expert-potato-772c18b7.pages.github.io/docs/zkdocs/security-of-zkps/" class="">Security of ZKPs</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://expert-potato-772c18b7.pages.github.io/docs/zkdocs/security-of-zkps/when-to-use-hvzk/" class="">Using HVZKP in the wrong context</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <a href="https://expert-potato-772c18b7.pages.github.io/docs/zkdocs/protocol-primitives/" class="">Protocol primitives</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://expert-potato-772c18b7.pages.github.io/docs/zkdocs/protocol-primitives/random-sampling/" class="">Random Sampling</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://expert-potato-772c18b7.pages.github.io/docs/zkdocs/protocol-primitives/fiat-shamir/" class="">Fiat-Shamir transformation</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://expert-potato-772c18b7.pages.github.io/docs/zkdocs/protocol-primitives/nums/" class="">Nothing-up-my-sleeve constructions</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://expert-potato-772c18b7.pages.github.io/docs/zkdocs/protocol-primitives/shamir/" class="">Shamir&#39;s Secret Sharing and its Pitfalls</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://expert-potato-772c18b7.pages.github.io/docs/zkdocs/protocol-primitives/verifiable-secret-sharing/" class="">Feldman&#39;s Verifiable Secret Sharing</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://expert-potato-772c18b7.pages.github.io/docs/zkdocs/protocol-primitives/alt-shamir/" class="">Alternative versions of Shamir&#39;s Secret Sharing scheme</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://expert-potato-772c18b7.pages.github.io/docs/zkdocs/bibliography/" class="">Bibliography</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>















</nav>




  <script>(function(){var a=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(b){localStorage.setItem("menu.scrollTop",a.scrollTop)}),a.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  $\newcommand{\alicebob}[3]{#1 & \ra{#2} & #3\\[-5pt]}$
$\newcommand{\bobalice}[3]{#1 & \la{#2} & #3\\[-5pt]}$
$\newcommand{\alicework}[1]{#1 & &\\[-5pt]}$
$\newcommand{\bobwork}[1]{ & & #1\\[-5pt]}$
$\newcommand{\work}[2]{#1 & & #2\\}$
$\newcommand{\allwork}[1]{ & #1 & \\}$
$\newcommand{\aliceseparator}{-------&&\\}$
$\newcommand{\bobseparator}{&&-------\\}$
$\newcommand{\foo}{\phantom{\text{bigarrowfitsallthis}}}$
$\newcommand{\ra}[1]{%
\vphantom{\xrightarrow{asd}}%
\smash{\xrightarrow[\foo]{#1}}%
}$
$\newcommand{\la}[1]{%
\vphantom{\xleftarrow{asd}}%
\smash{\xleftarrow[\foo]{#1}}%
}$
$\newcommand{\z}[1]{\mathbb{Z}_{#1}}$
$\newcommand{\zq}{\mathbb{Z}_\varq}$
$\newcommand{\zqs}{\mathbb{Z}_q^\ast}$
$\newcommand{\zns}[1]{\mathbb{Z}_{#1}^\ast}$
$\require{action}
\newcommand{\sampleSymb}{
  {\overset{\$}{\leftarrow}}
}$
$\newcommand{\field}[1]{\mathbb{F}_{#1}}$
$\newcommand{\sample}[1]{#1\sampleSymb\zq}$
$\newcommand{\sampleGeneric}[2]{#1\sampleSymb#2}$
$\newcommand{\sampleInterval}[2]{#1\sampleSymb\interval{#2}}$
$\newcommand{\sampleRange}[2]{#1\sampleSymb\range{#2}}$
$\newcommand{\samplezqs}[1]{\class{hover}{#1\sampleSymb\zqs}}$
$\newcommand{\sampleN}[2]{\class{hover}{#1\sampleSymb\z{#2}}}$
$\newcommand{\sampleNs}[2]{\class{hover}{#1\sampleSymb\z{#2}^\ast}}$
$\newcommand{\equalQ}{\overset{?}{=}}$
$\newcommand{\gQ}{\overset{?}{>}}$
$\newcommand{\inQ}{\overset{?}{\in}}$
$\newcommand{\cgroup}{\mathbb{G}}$
$\newcommand{\hash}[1]{\mathsf{Hash}({#1})}$
$\newcommand{\hashbit}[2]{\mathsf{Hash}({#1})\verb+[0:#2]+}$
$\newcommand{\naturals}{\mathbb{N}}$
$\newcommand{\sqfree}{L_\mathsf{square-free}}$
$\newcommand{\ceil}[1]{\lceil #1 \rceil}$
$\newcommand{\sampleSet}[2]{\class{hover}{#1\sampleSymb#2}}$
$\newcommand{\bunch}[1]{\{ #1_i\}_{i=1}^m}$
$\newcommand{\bunchi}[1]{\{ #1\}_{i=1}^m}$
$\newcommand{\forb}{\text{ for }i=1,\ldots,m}$
$\newcommand{\interval}[1]{[0, #1[}$

$\newcommand{\range}[1]{[#1]}$
$\newcommand{\rangeone}[1]{\{1, \dots,#1 -1 \}}$



$\newcommand{\vara}{\class{var var_a}{a}}$
$\newcommand{\varb}{\class{var var_b}{b}}$
$\newcommand{\varc}{\class{var var_c}{c}}$
$\newcommand{\vard}{\class{var var_d}{d}}$
$\newcommand{\varh}{\class{var var_h}{h}}$
$\newcommand{\varg}{\class{var var_g}{g}}$
$\newcommand{\varu}{\class{var var_u}{u}}$
$\newcommand{\varx}{\class{var var_x}{x}}$
$\newcommand{\varX}{\class{var var_X}{X}}$
$\newcommand{\varz}{\class{var var_z}{z}}$
$\newcommand{\varr}{\class{var var_r}{r}}$
$\newcommand{\varq}{\class{var var_q}{q}}$
$\newcommand{\varp}{\class{var var_p}{p}}$
$\newcommand{\vare}{\class{var var_e}{e}}$
$\newcommand{\vary}{\class{var var_y}{y}}$
$\newcommand{\varw}{\class{var var_w}{w}}$

$\newcommand{\varprover}{\class{var var_Prover}{\text{Prover}}}$
$\newcommand{\varprover}{\class{var var_Prover}{\text{Prover}}}$
$\newcommand{\varverifier}{\class{var var_Verifier}{\text{Verifier}}}$
$\newcommand{\varN}{\class{var var_N}{N}}$
$\newcommand{\rhovar}{\class{var var_ρ}{\rho}}$
$\newcommand{\sigmavar}{\class{var var_σ}{\sigma}}$
$\newcommand{\thetavar}{\class{var var_θ}{\theta}}$
$\newcommand{\muvar}{\class{var var_μ}{\mu}}$



$\newcommand{\true}{\mathsf{true}}$
$\newcommand{\false}{\mathsf{false}}$





<div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Variants of Schnorr&#39;s identification protocol</strong>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>



  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#non-interactive-protocols">Non-interactive protocols</a>
      <ul>
        <li><a href="#original">Original</a></li>
        <li><a href="#slim-original">Slim Original</a></li>
        <li><a href="#subtract">Subtract</a></li>
        <li><a href="#subtract--derive">Subtract + Derive</a></li>
      </ul>
    </li>
    <li><a href="#security-pitfalls">Security pitfalls</a></li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown"><h1 id="variants-of-schnorrs-identification-protocol">
  Variants of Schnorr&rsquo;s identification protocol
  <a class="anchor" href="#variants-of-schnorrs-identification-protocol">#</a>
</h1>
<p>All variants of Schnorr&rsquo;s protocol prove the knowledge of an $\varx$ such that $\varh = \varg^\varx$ for a public $\varh$.</p>
<p>The differences are tradeoffs between the size of the proof statements and a more costly proof verification, and smaller communication overhead.</p>
<blockquote class="book-hint info">
  <strong>Goal:</strong>
$\varprover$ convinces $\varverifier$ that they know $\varx$ such that $\varh = \varg^\varx$
</blockquote>

<ul>
<li><strong>Public input:</strong> cyclic group $\cgroup$ of prime order $\varq$, a $\cgroup$ generator $\varg$ and $\varh\in \cgroup$.</li>
<li><strong>Private input:</strong> $\varprover$ knows secret $\varx\in\zq$ such that $\varh = \varg^\varx$.</li>
</ul>
<p>We present all variants in their non-interactive version.</p>
<h2 id="non-interactive-protocols">
  Non-interactive protocols
  <a class="anchor" href="#non-interactive-protocols">#</a>
</h2>
<h3 id="original">
  Original
  <a class="anchor" href="#original">#</a>
</h3>


 $$
 \begin{array}{c}
 \work{\varprover}{\varverifier}
 \alicework{\sampleNs{\varr}{\varq}}
 \alicework{\varu = \varg^\varr}
 \alicework{\varc = \hash{\varg, \varq, \varh, \varu}}
 \alicework{\varz = \varr + \varx\cdot \varc}
 \alicebob{}{\varu, \varc, \varz}{}
 \bobwork{\varc \equalQ \hash{\varg, \varq, \varh, \varu}}
 \bobwork{\varg^\varz \equalQ \varu \cdot \varh ^\varc }
 \end{array}
 $$

<hr>
<h3 id="slim-original">
  Slim Original
  <a class="anchor" href="#slim-original">#</a>
</h3>
<p>In this variant, the prover does not send the value of $\varc$ which has to be computed by the verifier.


 $$
 \begin{array}{c}
 \work{\varprover}{\varverifier}
 \alicework{\sampleNs{\varr}{\varq}}
 \alicework{\varu = \varg^\varr}
 \alicework{\varc = \hash{\varg, \varq, \varh, \varu}}
 \alicework{\varz = \varr + \varx\cdot \varc}
 \alicebob{}{\varu, \varz}{}
 \bobwork{\bar{\varc} = \hash{\varg, \varq, \varh, \varu}}
 \bobwork{\varg^\varz \equalQ \varu \cdot \varh ^\overline{\varc} }
 \end{array}
 $$
</p>
<hr>
<h3 id="subtract">
  Subtract
  <a class="anchor" href="#subtract">#</a>
</h3>
<p>In this variant, the prover uses a subtraction to compute the value of $\varz$.</p>


 $$
 \begin{array}{c}
 \work{\varprover}{\varverifier}
 \alicework{\sampleNs{\varr}{\varq}}
 \alicework{\varu = \varg^\varr}
 \alicework{\varc = \hash{\varg, \varq, \varh, \varu}}
 \alicework{\varz = \varr - \varx\cdot \varc}
 \alicebob{}{\varu, \varc, \varz}{}
 \bobwork{\varc \equalQ \hash{\varg, \varq, \varh, \varu}}
 \bobwork{\varg^\varz \cdot \varh ^\varc \equalQ \varu  }
 \end{array}
 $$

<hr>
<h3 id="subtract--derive">
  Subtract + Derive
  <a class="anchor" href="#subtract--derive">#</a>
</h3>
<p>In this variant, the prover uses a subtraction to compute the value of $\varz$ and does not send $\varu$, which the verifier derives from the values they know.</p>


 $$
 \begin{array}{c}
 \work{\varprover}{\varverifier}
 \alicework{\sampleNs{\varr}{\varq}}
 \alicework{\varu = \varg^\varr}
 \alicework{\varc = \hash{\varg, \varq, \varh, \varu}}
 \alicework{\varz = \varr - \varx\cdot \varc}
 \alicebob{}{\varc, \varz}{}
 \bobwork{\bar{\varu} = \varg^\varz \cdot \varh^\varc}
 \bobwork{\bar{\varc} = \hash{\varg, \varq, \varh, \bar{\varu}}}
 \bobwork{\varc \equalQ \bar{\varc} }
 \end{array}
 $$

<h2 id="security-pitfalls">
  Security pitfalls
  <a class="anchor" href="#security-pitfalls">#</a>
</h2>
<p>These variants suffer from the same pitfalls as the original Schnorr scheme, with some adjustments when $\varz$ is computed with a subtraction:</p>
<ul>
<li><strong>Verifier trusts prover:</strong>
<ul>
<li>$\varverifier$ uses $g$ and $q$ provided in the proof instead of using publicly known values.</li>
<li>When the $varprover$ sends $\varc$, if the $\varverifier$ assumes that the hash $\varc$ is correctly computed and does not compute it themself. Both are high severity issues since $\varprover$ can forge proofs.</li>
</ul>
</li>
<li><strong>Weak Fiat-Shamir transformation:</strong> It is a common issue that some parameters are missing on the hash computation $\hash{\varg, \varq, \varh, \varu}$:
<ul>
<li>$\varh$ or $\varu$ missing: high severity issue. Read <a href="https://expert-potato-772c18b7.pages.github.io/docs/zkdocs/protocol-primitives/fiat-shamir/">Fiat-Shamir transformation</a> for more details.</li>
<li>$\varg$ or $\varq$ missing: usually no issue, but it might be one if the Verifier uses these parameters directly from the proof structure. This way, the prover can provide bad generators or orders to forge the proof.</li>
</ul>
</li>
<li><strong>Weak randomness:</strong> Bad randomness may cause the secret $\varx$ to leak. If $\varr$ is reused twice with two different non-interactive challenges then:
$$ \frac{\varz - \varz'}{\varc-\varc'} = \frac{\varr -\varr + \varx\cdot(\varc - \varc')}{\varc-\varc'} = \varx  \enspace,$$
or when $\varz$ is computed with a subtraction:
$$ \frac{\varz - \varz'}{\varc'-\varc} = \frac{\varr -\varr + \varx\cdot(\varc' - \varc)}{\varc'-\varc} = \varx  \enspace.$$</li>
<li><strong>Replay attacks:</strong> After a non-interactive proof is public, it will always be valid and anyone could pretend to know the secret value. To prevent this, consider adding the ID of both the prover and the verifier inside of the Fiat-Shamir hash computation.</li>
</ul>

    <h2>References <a class="anchor" href="#references">#</a></h2>
      
              
              <ul>
                  <li>[RFC] <a href="https://www.rfc-editor.org/rfc/rfc8235.html" title="RFC: Schnorr Non-interactive Zero-Knowledge Proof" target="_blank">Informational RFC: Schnorr Non-interactive Zero-Knowledge Proof</a> (2017).</li>
              </ul>
      
    

  </article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function a(c){const a=window.getSelection(),b=document.createRange();b.selectNodeContents(c),a.removeAllRanges(),a.addRange(b)}document.querySelectorAll("pre code").forEach(b=>{b.addEventListener("click",function(c){a(b.parentElement),navigator.clipboard&&navigator.clipboard.writeText(b.parentElement.textContent)})})})()</script>


 
        
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},SVG: {addMMLclasses: true},
    loader: { load: ['[tex]/textmacros','[tex]/newcommand','[tex]/action'] },
    tex: { packages: { '[+]': ['newcommand','action', 'textmacros'] } }
  });
  </script>

  
  
  
  <script src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS_CHTML-full"></script>



  
  <script language="javascript" type="text/javascript" src="/js/interactive_variables.js"></script>

  
  <script>
    MathJax.Hub.Queue(function () {
      setupInteractiveVariables()
    });
  </script>









  
      

      

  

      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#non-interactive-protocols">Non-interactive protocols</a>
      <ul>
        <li><a href="#original">Original</a></li>
        <li><a href="#slim-original">Slim Original</a></li>
        <li><a href="#subtract">Subtract</a></li>
        <li><a href="#subtract--derive">Subtract + Derive</a></li>
      </ul>
    </li>
    <li><a href="#security-pitfalls">Security pitfalls</a></li>
  </ul>
</nav>


 

        
        <br>
        <br>
        
          <button onclick="resetVariableNames()">Reset variables names</button>
        
      </div>
    </aside>
    
  </main>

  
</body>
</html>












